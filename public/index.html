<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTRL-ALT-FIT - AI Nutrition Analysis</title>
    <meta name="description" content="CTRL-ALT-FIT: AI-powered meal tracking and nutrition analysis">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Lucide icons as inline SVG components
        const Camera = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/>
                <circle cx="12" cy="13" r="3"/>
            </svg>
        );

        const Footprints = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z"/>
                <path d="M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z"/>
            </svg>
        );

        const TrendingUp = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/>
                <polyline points="16 7 22 7 22 13"/>
            </svg>
        );

        const Plus = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
        );

        const X = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
        );

        const CtrlAltFitLogo = ({ className = "" }) => (
            <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" className={className} aria-hidden="true">
                <defs>
                    <linearGradient id="cafLogoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stopColor="#10b981" />
                        <stop offset="100%" stopColor="#2563eb" />
                    </linearGradient>
                </defs>
                <rect x="4" y="4" width="56" height="56" rx="14" fill="url(#cafLogoGradient)" />
                <rect x="16" y="18" width="5" height="28" rx="2.5" fill="#ffffff" />
                <rect x="16" y="18" width="20" height="5" rx="2.5" fill="#ffffff" />
                <rect x="43" y="18" width="5" height="28" rx="2.5" fill="#ffffff" />
                <rect x="28" y="29.5" width="23" height="5" rx="2.5" fill="#ffffff" />
            </svg>
        );

        function MealTrackerApp() {
            const mealTypes = [
                { id: 'breakfast', label: 'Breakfast', icon: 'ðŸŒ…' },
                { id: 'lunch', label: 'Lunch', icon: 'â˜€ï¸' },
                { id: 'snack', label: 'Snack', icon: 'ðŸŽ' },
                { id: 'dinner', label: 'Dinner', icon: 'ðŸŒ™' },
                { id: 'other', label: 'Other', icon: 'ðŸ½ï¸' },
            ];
            const mealTypeMap = Object.fromEntries(mealTypes.map((type) => [type.id, type]));
            const [meals, setMeals] = useState([]);
            const [steps, setSteps] = useState(0);
            const [isAnalyzing, setIsAnalyzing] = useState(false);
            const [selectedMealType, setSelectedMealType] = useState('breakfast');
            const [showCamera, setShowCamera] = useState(false);
            const [capturedImage, setCapturedImage] = useState(null);
            const videoRef = useRef(null);
            const canvasRef = useRef(null);
            const fileInputRef = useRef(null);
            const streamRef = useRef(null);
            const stepListenerRef = useRef(null);
            const stepCounterActiveRef = useRef(false);
            const lastMotionYRef = useRef(null);
            const lastStepTimestampRef = useRef(0);

            // Load meals from localStorage on mount
            useEffect(() => {
                const savedMeals = localStorage.getItem('meals');
                if (savedMeals) {
                    try {
                        const parsedMeals = JSON.parse(savedMeals);
                        const normalizedMeals = Array.isArray(parsedMeals) ? parsedMeals.map((meal) => {
                            const fallbackDate = typeof meal?.id === 'number' ? new Date(meal.id) : new Date();
                            const fallbackIso = Number.isNaN(fallbackDate.getTime()) ? new Date().toISOString() : fallbackDate.toISOString();

                            return {
                                ...meal,
                                mealType: meal?.mealType || 'other',
                                createdAt: meal?.createdAt || fallbackIso,
                            };
                        }) : [];
                        setMeals(normalizedMeals);
                    } catch (error) {
                        console.error('Failed to parse saved meals:', error);
                        setMeals([]);
                    }
                }
            }, []);

            // Save meals to localStorage whenever they change
            useEffect(() => {
                localStorage.setItem('meals', JSON.stringify(meals));
            }, [meals]);

            // Step counter using device motion
            useEffect(() => {
                let stepCount = parseInt(localStorage.getItem('dailySteps') || '0');
                setSteps(stepCount);

                const now = new Date();
                const tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);
                const msUntilMidnight = tomorrow - now;
                
                const midnightTimer = setTimeout(() => {
                    localStorage.setItem('dailySteps', '0');
                    setSteps(0);
                }, msUntilMidnight);

                return () => clearTimeout(midnightTimer);
            }, []);

            const requestPedometerPermission = async () => {
                if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
                    try {
                        const permission = await DeviceMotionEvent.requestPermission();
                        if (permission === 'granted') {
                            startStepCounting();
                            alert('Step counter enabled! Start walking to see it update.');
                        }
                    } catch (error) {
                        alert('Permission denied. Step counting requires motion sensor access.');
                    }
                } else {
                    alert('Step counter is only available on mobile devices with motion sensors (iPhone, Android phones).');
                }
            };

            const startStepCounting = () => {
                if (stepCounterActiveRef.current) {
                    return;
                }

                const threshold = 1.8;
                const minStepIntervalMs = 450;

                const onDeviceMotion = (event) => {
                    const acceleration = event.accelerationIncludingGravity;
                    if (!acceleration || typeof acceleration.y !== 'number') {
                        return;
                    }

                    const y = acceleration.y;

                    // Prime baseline on first reading to avoid false +1 step when enabling.
                    if (lastMotionYRef.current === null) {
                        lastMotionYRef.current = y;
                        return;
                    }

                    const delta = Math.abs(y - lastMotionYRef.current);
                    const now = Date.now();

                    if (delta > threshold && now - lastStepTimestampRef.current >= minStepIntervalMs) {
                        lastStepTimestampRef.current = now;
                        setSteps((prevSteps) => {
                            const nextSteps = prevSteps + 1;
                            localStorage.setItem('dailySteps', nextSteps.toString());
                            return nextSteps;
                        });
                    }

                    lastMotionYRef.current = y;
                };

                stepListenerRef.current = onDeviceMotion;
                stepCounterActiveRef.current = true;
                window.addEventListener('devicemotion', onDeviceMotion);
            };

            useEffect(() => {
                return () => {
                    if (stepListenerRef.current) {
                        window.removeEventListener('devicemotion', stepListenerRef.current);
                    }
                };
            }, []);

            const startCamera = async () => {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { 
                            facingMode: { ideal: 'environment' },
                            width: { ideal: 1280 },
                            height: { ideal: 720 }
                        } 
                    });
                    streamRef.current = stream;
                    setShowCamera(true);
                    
                    setTimeout(() => {
                        if (videoRef.current) {
                            videoRef.current.srcObject = stream;
                            videoRef.current.play().catch(err => {
                                console.error('Play error:', err);
                            });
                        }
                    }, 100);
                } catch (err) {
                    console.error('Camera access denied:', err);
                    alert('Camera access denied. Please grant camera permission or use the Upload Photo option instead.');
                }
            };

            const stopCamera = () => {
                if (streamRef.current) {
                    streamRef.current.getTracks().forEach(track => track.stop());
                    streamRef.current = null;
                }
                setShowCamera(false);
                setCapturedImage(null);
            };

            const capturePhoto = () => {
                const video = videoRef.current;
                const canvas = canvasRef.current;
                
                if (video && canvas) {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(video, 0, 0);
                    const imageData = canvas.toDataURL('image/jpeg', 0.8);
                    setCapturedImage(imageData);
                    stopCamera();
                    analyzeMeal(imageData);
                }
            };

            const handleFileUpload = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        setCapturedImage(e.target.result);
                        analyzeMeal(e.target.result);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const analyzeMeal = async (imageData) => {
                setIsAnalyzing(true);
                
                try {
                    const response = await fetch('/api/analyze-meal', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ imageData })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || `API error: ${response.status}`);
                    }

                    const nutritionData = await response.json();
                    const now = new Date();
                    
                    const newMeal = {
                        id: now.getTime(),
                        createdAt: now.toISOString(),
                        timestamp: now.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' }),
                        mealType: selectedMealType,
                        image: imageData,
                        ...nutritionData
                    };
                    
                    setMeals(prev => [newMeal, ...prev]);
                } catch (error) {
                    console.error('Analysis error:', error);
                    alert('Failed to analyze meal. ' + error.message);
                } finally {
                    setIsAnalyzing(false);
                    setCapturedImage(null);
                }
            };

            const deleteMeal = (id) => {
                setMeals(prev => prev.filter(meal => meal.id !== id));
            };

            const getMealDate = (meal) => {
                const candidates = [meal?.createdAt, meal?.timestamp];
                if (typeof meal?.id === 'number') {
                    candidates.push(meal.id);
                }

                for (const value of candidates) {
                    const parsed = new Date(value);
                    if (!Number.isNaN(parsed.getTime())) {
                        return parsed;
                    }
                }

                return new Date();
            };

            const isSameDay = (left, right) => (
                left.getFullYear() === right.getFullYear() &&
                left.getMonth() === right.getMonth() &&
                left.getDate() === right.getDate()
            );

            const now = new Date();
            const todaysMeals = meals.filter((meal) => isSameDay(getMealDate(meal), now));
            const todaysMealsSorted = [...todaysMeals].sort((a, b) => getMealDate(b) - getMealDate(a));
            const selectedMealTypeMeta = mealTypeMap[selectedMealType] || mealTypeMap.other;
            const todaysCountByType = mealTypes.reduce((acc, type) => {
                acc[type.id] = todaysMeals.filter((meal) => (meal.mealType || 'other') === type.id).length;
                return acc;
            }, {});

            const groupedMeals = mealTypes.map((type) => {
                const entries = todaysMealsSorted.filter((meal) => (meal.mealType || 'other') === type.id);
                const calories = entries.reduce((sum, meal) => sum + (Number(meal.calories) || 0), 0);
                return { ...type, entries, calories };
            }).filter((group) => group.entries.length > 0);

            const todaysTotals = todaysMeals.reduce((acc, meal) => ({
                calories: acc.calories + (meal.calories || 0),
                protein: acc.protein + (meal.protein || 0),
                carbs: acc.carbs + (meal.carbs || 0),
                fat: acc.fat + (meal.fat || 0),
                fiber: acc.fiber + (meal.fiber || 0)
            }), { calories: 0, protein: 0, carbs: 0, fat: 0, fiber: 0 });

            return (
                <div className="min-h-screen bg-gradient-to-br from-green-50 to-blue-50">
                    <div className="max-w-4xl mx-auto p-4">
                        {/* Header */}
                        <div className="bg-white rounded-2xl shadow-lg p-6 mb-6">
                            <div className="flex items-center gap-3 mb-4">
                                <CtrlAltFitLogo className="h-11 w-11 shrink-0" />
                                <h1 className="text-3xl font-bold text-gray-800">CTRL-ALT-FIT</h1>
                            </div>
                            
                            {/* Daily Summary Cards */}
                            <div className="grid grid-cols-2 gap-4 mb-4">
                                <div className="bg-gradient-to-br from-orange-100 to-orange-200 rounded-xl p-4">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-orange-700 text-sm font-medium">Today's Calories</p>
                                            <p className="text-3xl font-bold text-orange-900">{Math.round(todaysTotals.calories)}</p>
                                        </div>
                                        <TrendingUp size={32} className="text-orange-600" />
                                    </div>
                                </div>
                                
                                <div className="bg-gradient-to-br from-blue-100 to-blue-200 rounded-xl p-4">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-blue-700 text-sm font-medium">Steps Today</p>
                                            <p className="text-3xl font-bold text-blue-900">{steps.toLocaleString()}</p>
                                        </div>
                                        <Footprints size={32} className="text-blue-600" />
                                    </div>
                                </div>
                            </div>

                            {/* Macros Summary */}
                            <div className="grid grid-cols-4 gap-3 mb-4">
                                <div className="bg-purple-50 rounded-lg p-3 text-center">
                                    <p className="text-xs text-purple-600 font-medium">Protein</p>
                                    <p className="text-xl font-bold text-purple-900">{Math.round(todaysTotals.protein)}g</p>
                                </div>
                                <div className="bg-yellow-50 rounded-lg p-3 text-center">
                                    <p className="text-xs text-yellow-600 font-medium">Carbs</p>
                                    <p className="text-xl font-bold text-yellow-900">{Math.round(todaysTotals.carbs)}g</p>
                                </div>
                                <div className="bg-red-50 rounded-lg p-3 text-center">
                                    <p className="text-xs text-red-600 font-medium">Fat</p>
                                    <p className="text-xl font-bold text-red-900">{Math.round(todaysTotals.fat)}g</p>
                                </div>
                                <div className="bg-green-50 rounded-lg p-3 text-center">
                                    <p className="text-xs text-green-600 font-medium">Fiber</p>
                                    <p className="text-xl font-bold text-green-900">{Math.round(todaysTotals.fiber)}g</p>
                                </div>
                            </div>

                            <div className="mb-4 rounded-xl border border-emerald-100 bg-emerald-50 px-3 py-2 text-sm text-emerald-800">
                                AI Model: Gemini 2.5 Flash-Lite (Free Tier)
                            </div>

                            <div className="mb-4">
                                <p className="text-sm font-semibold text-gray-700 mb-2">Log This As</p>
                                <div className="grid grid-cols-2 md:grid-cols-5 gap-2">
                                    {mealTypes.map((mealType) => {
                                        const isActive = selectedMealType === mealType.id;
                                        const count = todaysCountByType[mealType.id] || 0;
                                        return (
                                            <button
                                                key={mealType.id}
                                                onClick={() => setSelectedMealType(mealType.id)}
                                                className={`rounded-xl border px-3 py-2 text-left transition-all ${
                                                    isActive
                                                        ? 'border-green-500 bg-green-50 shadow-sm'
                                                        : 'border-gray-200 bg-white hover:border-green-300'
                                                }`}
                                            >
                                                <p className="text-sm font-semibold text-gray-800">{mealType.icon} {mealType.label}</p>
                                                <p className="text-xs text-gray-500">{count} today</p>
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>

                            {/* Action Buttons */}
                            <div className="grid grid-cols-2 gap-3">
                                <button
                                    onClick={startCamera}
                                    className="bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl py-3 px-4 font-semibold flex items-center justify-center gap-2 hover:from-green-600 hover:to-green-700 transition-all shadow-md"
                                >
                                    <Camera size={20} />
                                    Scan {selectedMealTypeMeta.label}
                                </button>
                                
                                <button
                                    onClick={() => fileInputRef.current.click()}
                                    className="bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl py-3 px-4 font-semibold flex items-center justify-center gap-2 hover:from-blue-600 hover:to-blue-700 transition-all shadow-md"
                                >
                                    <Plus size={20} />
                                    Upload {selectedMealTypeMeta.label}
                                </button>
                            </div>

                            <button
                                onClick={requestPedometerPermission}
                                className="w-full mt-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl py-3 px-4 font-semibold flex items-center justify-center gap-2 hover:from-purple-600 hover:to-purple-700 transition-all shadow-md"
                            >
                                <Footprints size={20} />
                                Enable Step Counter
                            </button>
                        </div>

                        {/* Camera View */}
                        {showCamera && (
                            <div>
                                <div style={{
                                    position: 'fixed', 
                                    top: 0, 
                                    left: 0, 
                                    right: 0, 
                                    bottom: 0, 
                                    backgroundColor: 'black', 
                                    zIndex: 99999
                                }}>
                                    <video
                                        ref={videoRef}
                                        autoPlay
                                        playsInline
                                        muted
                                        style={{
                                            position: 'absolute',
                                            top: 0,
                                            left: 0,
                                            width: '100%',
                                            height: '100%',
                                            objectFit: 'cover'
                                        }}
                                    />
                                    <div style={{
                                        position: 'absolute',
                                        bottom: 0,
                                        left: 0,
                                        right: 0,
                                        backgroundColor: 'rgba(0,0,0,0.8)',
                                        padding: '30px 20px',
                                        display: 'flex',
                                        justifyContent: 'center',
                                        gap: '30px',
                                        zIndex: 100000
                                    }}>
                                        <button
                                            onClick={stopCamera}
                                            style={{
                                                backgroundColor: '#ef4444',
                                                color: 'white',
                                                border: 'none',
                                                borderRadius: '12px',
                                                padding: '18px 30px',
                                                fontSize: '18px',
                                                fontWeight: 'bold',
                                                cursor: 'pointer',
                                                minWidth: '120px'
                                            }}
                                        >
                                            âœ• Cancel
                                        </button>
                                        <button
                                            onClick={capturePhoto}
                                            style={{
                                                backgroundColor: '#22c55e',
                                                color: 'white',
                                                border: 'none',
                                                borderRadius: '12px',
                                                padding: '18px 40px',
                                                fontSize: '18px',
                                                fontWeight: 'bold',
                                                cursor: 'pointer',
                                                minWidth: '150px'
                                            }}
                                        >
                                            ðŸ“¸ Capture
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Analysis Loading */}
                        {isAnalyzing && (
                            <div className="bg-white rounded-2xl shadow-lg p-8 mb-6 text-center">
                                <div className="animate-spin rounded-full h-16 w-16 border-b-4 border-green-500 mx-auto mb-4"></div>
                                <p className="text-gray-600 font-medium">Analyzing your meal...</p>
                            </div>
                        )}

                        {/* Meals List */}
                        <div className="space-y-4">
                            {groupedMeals.map((group) => (
                                <div key={group.id} className="bg-white rounded-2xl shadow-lg overflow-hidden">
                                    <div className="bg-gradient-to-r from-gray-50 to-slate-50 border-b border-gray-200 px-4 py-3 flex items-center justify-between">
                                        <h2 className="text-base font-bold text-gray-800">{group.icon} {group.label}</h2>
                                        <p className="text-sm text-gray-600">{group.entries.length} meal{group.entries.length > 1 ? 's' : ''} â€¢ {Math.round(group.calories)} kcal</p>
                                    </div>
                                    <div className="p-4 space-y-4">
                                        {group.entries.map((meal) => (
                                            <div key={meal.id} className="rounded-xl border border-gray-200 overflow-hidden">
                                                <div className="relative">
                                                    <img 
                                                        src={meal.image} 
                                                        alt={meal.name}
                                                        className="w-full h-48 object-cover"
                                                    />
                                                    <button
                                                        onClick={() => deleteMeal(meal.id)}
                                                        className="absolute top-2 right-2 bg-red-500 text-white rounded-full p-2 hover:bg-red-600 transition-colors"
                                                    >
                                                        <X size={16} />
                                                    </button>
                                                </div>
                                                <div className="p-4">
                                                    <h3 className="font-bold text-lg text-gray-800 mb-1">{meal.name}</h3>
                                                    <p className="text-sm text-gray-500 mb-3">{meal.timestamp || getMealDate(meal).toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' })}</p>
                                                    
                                                    {meal.items && meal.items.length > 0 && (
                                                        <p className="text-sm text-gray-600 mb-3">
                                                            <span className="font-medium">Items:</span> {meal.items.join(', ')}
                                                        </p>
                                                    )}
                                                    
                                                    <div className="grid grid-cols-5 gap-2">
                                                        <div className="text-center bg-orange-50 rounded-lg p-2">
                                                            <p className="text-xs text-orange-600 font-medium">Calories</p>
                                                            <p className="text-lg font-bold text-orange-900">{Math.round(meal.calories)}</p>
                                                        </div>
                                                        <div className="text-center bg-purple-50 rounded-lg p-2">
                                                            <p className="text-xs text-purple-600 font-medium">Protein</p>
                                                            <p className="text-lg font-bold text-purple-900">{Math.round(meal.protein)}g</p>
                                                        </div>
                                                        <div className="text-center bg-yellow-50 rounded-lg p-2">
                                                            <p className="text-xs text-yellow-600 font-medium">Carbs</p>
                                                            <p className="text-lg font-bold text-yellow-900">{Math.round(meal.carbs)}g</p>
                                                        </div>
                                                        <div className="text-center bg-red-50 rounded-lg p-2">
                                                            <p className="text-xs text-red-600 font-medium">Fat</p>
                                                            <p className="text-lg font-bold text-red-900">{Math.round(meal.fat)}g</p>
                                                        </div>
                                                        <div className="text-center bg-green-50 rounded-lg p-2">
                                                            <p className="text-xs text-green-600 font-medium">Fiber</p>
                                                            <p className="text-lg font-bold text-green-900">{Math.round(meal.fiber)}g</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            ))}

                            {todaysMeals.length === 0 && !isAnalyzing && (
                                <div className="bg-white rounded-2xl shadow-lg p-12 text-center">
                                    <Camera size={48} className="mx-auto mb-4 text-gray-300" />
                                    <p className="text-gray-500 font-medium">No meals logged for today</p>
                                    <p className="text-gray-400 text-sm mt-2">Pick a meal slot and scan your first meal.</p>
                                </div>
                            )}
                        </div>

                        <input
                            ref={fileInputRef}
                            type="file"
                            accept="image/*"
                            onChange={handleFileUpload}
                            className="hidden"
                        />

                        <canvas ref={canvasRef} className="hidden" />
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MealTrackerApp />);
    </script>
</body>
</html>
